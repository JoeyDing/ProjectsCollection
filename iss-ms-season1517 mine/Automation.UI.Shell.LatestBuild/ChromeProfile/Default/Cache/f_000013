var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)};requirejs.config({waitSeconds:0,paths:{jquery:["libs/jquery"],aria:"libs/aria-web-telemetry",i18n:"libs/i18n"},shim:{jquery:{exports:"$"}}}),requirejs(["app"]),define("utils/Constants",["require","exports"],function(e,t){"use strict";!function(e){e[e.None=0]="None",e[e.UnsupportedBrowser=1]="UnsupportedBrowser",e[e.InvalidConference=2]="InvalidConference",e[e.ServerBusy=3]="ServerBusy",e[e.FailedOver=4]="FailedOver",e[e.Other=5]="Other"}(t.ErrorType||(t.ErrorType={}));var n=(t.ErrorType,function(){function e(){}return e.MethodGET="GET",e.MethodPOST="POST",e.AutoApplyStrings=[],e.AutoApplyAriaStrings=[],e.MockDataJsonFilesPath="mockdata/",e.SkypeErrorImagePath="assets/sad_100.png",e.SkypeTitleLogoImagePath="assets/LogoWhite.32x32.png",e.SkypeAppLogoImagePath="assets/Logo.80x80.png",e.SkypeAppLogoImagePathAndroid="assets/SfBLogo_Android.png",e.SkypeAppLogoImagePathiOS="assets/SfBLogo_iOS.png",e.SkypeAppLogoImagePathWP="assets/SfBLogo_WinPhone.png",e.SkypeBGImagePath="assets/background-skype-meetings-blue.jpeg",e.SkypeSafariImagePath="assets/Safari.png",e.SkypeFirefoxImagePath="assets/Firefox.png",e.SkypeJoinSpinImagePath="assets/spinner64.gif",e.LaunchMeetingAppForActivateParameter="launchMeetingApp=false",e.LaunchMeetingAppForLaunchParameter="launchMeetingApp=true",e.CheckAppParameter="check=true",e.JoinUrlParameter="url=",e.JoinTokenParameter="token=",e.JoinReqTypeParamName="requestType",e.ShellAppLaunchProtocol="sfb:",e.ShellAppActiveObject="Microsoft.SkypeForBusinessPlugin16.2.VersionQuery",e.TimeoutForDownload=2e4,e.TimeoutForCheckDownload=3e3,e.TimeoutForCancelDownload=6e4,e.TimeoutForDownloadBubble=6e4,e.TelemetryInfoTypeName="Info",e.TelemetryErrorTypeName="Error",e.LaunchFinishedCookieName="sfbShellAppLaunched",e.ShellAppVersionCookieName="sfbShellAppVersion",e.RememberMeCookieName="rememberme",e.ContactMeCookieName="contactme",e.UserNameCookieName="user",e.UserEmailCookieName="email",e.ClientSelectionCookieName="clientselection",e.LwaClient="LwaClient",e.DesktopClient="DesktopClient",e.CheckboxChecked="checked",e.CheckboxUnchecked="unchecked",e.DefaultCookieExpireDays=180,e.TestCookieExpire1Minute=694444e-9,e.HelpUrl="https://aka.ms/skypemeetings-help",e.HelpUrlAndroid="https://aka.ms/skypemeetings-android-help",e.HelpUrliOS="https://aka.ms/skypemeetings-iphone-help",e.HelpUrlWinPhone="https://aka.ms/skypemeetings-windowsphone-help",e.LwaMacShellAppIntaller="https://mlccdn.blob.core.windows.net/dev/LWA/plugins/mac/SkypeMeetingsApp.dmg",e.LwaDesktopShellAppIntaller="https://mlccdn.blob.core.windows.net/dev/LWA/plugins/windows/SkypeMeetingsApp.msi",e.IsSafariPluginDetectionEnabled=!1,e.AriaToken="5226daabccfe483caee8483cb9bbc99a-7f0e0f84-9536-4d74-85f2-5debbf7cba4d-7618",e}());t.__esModule=!0,t.default=n}),define("utils/Logger",["require","exports"],function(e,t){"use strict";var n=function(){function e(){}return e.verbose=function(t){e.log(t,0)},e.info=function(t){e.log(t,2)},e.warn=function(t){e.log(t,3)},e.error=function(t){e.log(t,4)},e.log=function(t,n){switch(void 0===n&&(n=1),t=(new Date).toISOString()+" "+t,n){case 0:e.logWithColor(t,"#aaaaaa");break;case 1:console.log(t);break;case 2:console.info?console.info(t):console.log("INFO - "+t);break;case 3:console.warn?console.warn(t):console.log("WARNING - "+t);break;case 4:console.error?console.error(t):console.log("ERROR - "+t);break;default:console.log(t)}},e.logWithColor=function(e,t){"ActiveXObject"in window||window.MSStream?console.log(e):console.log("%c"+e,"color: "+t)},e}();t.__esModule=!0,t.default=n}),define("utils/Helper",["require","exports","utils/Constants","utils/Logger","jquery"],function(e,t,n,o){"use strict";var i=function(){function e(){}return e.getFormatedString=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e.replace(/{(\d+)}/g,function(e,n){return void 0!==t[n]?t[n]:e})},e.encodeXMLEntities=function(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;"):""},e.decodeXMLEntities=function(e){return e?e.replace(/&apos;/g,"'").replace(/&quot;/g,'"').replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&amp;/g,"&"):""},e.getHTMLAttribute=function(e){return document.getElementsByTagName("html")[0].getAttribute(e)||""},e.hasHTMLAttribute=function(e){return document.getElementsByTagName("html")[0].hasAttribute(e)},e.getBooleanHTMLAttribute=function(e,t){return t?"false"!==this.getHTMLAttribute(e).toLowerCase():"true"===this.getHTMLAttribute(e).toLowerCase()},e.getDecodedHTMLAttribute=function(e){return this.decodeXMLEntities(this.getHTMLAttribute(e))||""},e.GetRedirectURL=function(){return this.getDecodedHTMLAttribute("sb-data-domainOwnerJoinLauncherUrl")},e.IsValidMeeting=function(){return this.getBooleanHTMLAttribute("sb-data-validMeeting",!1)},e.GetLwaURL=function(){return this.getDecodedHTMLAttribute("sb-data-reachUrl")},e.GetMeetUrl=function(){return this.getDecodedHTMLAttribute("sb-data-meetUrl")},e.GetIsOnPrem=function(){return this.getBooleanHTMLAttribute("sb-data-isOnPrem",!1)},e.GetEnableTelemetry=function(){return this.getBooleanHTMLAttribute("sb-data-enableTelemetry",!1)},e.GetSkypeMeetingAppOrPlugInUrl=function(){return this.IsMac()?n.default.LwaMacShellAppIntaller:n.default.LwaDesktopShellAppIntaller},e.GetEscapedXml=function(){return this.getHTMLAttribute("sb-data-escapedXml")},e.GetLocaleString=function(){return null==this.localeString&&(this.localeString=this.getHTMLAttribute("sb-data-language")),this.localeString.toLowerCase()},e.GetIsMobilePlatform=function(){return null==this.isMobilePlatform&&(this.isMobilePlatform=this.IsIOS()||this.IsAndroid()),this.isMobilePlatform},e.GetScriptRootPath=function(){return rootPath},e.GetTelemetryId=function(){return null==this.telemetryId&&(this.telemetryId=this.getHTMLAttribute("sb-data-telemetryid")),this.telemetryId},e.GetLyncLaunchLink=function(){return this.getDecodedHTMLAttribute("sb-data-lyncLaunchLink")},e.GetDiagInfo=function(){return this.getHTMLAttribute("sb-data-diagInfo")},e.GetErrorType=function(){switch(parseInt(this.getHTMLAttribute("sb-data-errorCode"))){case-1:return n.ErrorType.None;case 6:return n.ErrorType.InvalidConference;case 7:return n.ErrorType.ServerBusy;case 8:return n.ErrorType.FailedOver;default:return n.ErrorType.Other}},e.GetCurrentUrl=function(){var e=window.location.href;return"#"===e.slice(-1)&&(e=e.substring(0,e.length-1)),e},e.GetHostname=function(){return window.location.hostname},e.GetServerPath=function(){return window.location.origin?window.location.origin:window.location.protocol+"//"+window.location.host},e.isLocalHost=function(){return window.location.href.indexOf("localhost")!==-1},e.GetUserAgent=function(){return navigator.userAgent},e.GetPlatform=function(){return navigator.platform},e.IsMac=function(){return this.GetPlatform().toUpperCase().indexOf("MAC")!==-1},e.IsWindows=function(){return this.GetPlatform().toUpperCase().indexOf("WIN")!==-1},e.IsSafari=function(){var e=this.GetUserAgent().toLowerCase();return/safari/.test(e)&&!/chrome/.test(e)&&!/crios/.test(e)&&!/edge/.test(e)&&!/firefox/.test(e)},e.IsChrome=function(){var e=this.GetUserAgent().toLowerCase();return/chrome/.test(e)&&!/edge/.test(e)},e.IsFireFox=function(){var e=this.GetUserAgent().toLowerCase();return/firefox/.test(e)},e.IsSfBShell=function(){var e=this.GetUserAgent().toLowerCase();return/sfbshell/.test(e)},e.IsIntentBasedChrome=function(){var e=this.GetUserAgent().toLowerCase(),t=/chrome\/([0-9]+)/.exec(e);return null!==t&&parseInt(t[1],10)>=25},e.IsEdge=function(){var e=this.GetUserAgent().toLowerCase();return/edge/.test(e)},e.IsIE=function(){var e=this.GetUserAgent().toLowerCase();return/msie 10\.\d+/.test(e)||/trident\/\d+\.\d+/.test(e)&&/\brv:\d+\.\d+/.test(e)},e.IsIOS=function(){var e=this.GetUserAgent().toLowerCase();return/ipad|iphone|ipod/.test(e)&&!window.MSStream},e.IsAndroid=function(){var e=this.GetUserAgent().toLowerCase();return/android/.test(e)},e.IsWinPhone=function(){var e=this.GetUserAgent().toLowerCase();return/windows phone/.test(e)},e.IsValidEmail=function(e){return/^(([^<>()\[\]\.,;:\s@\"]+(\.[^<>()\[\]\.,;:\s@\"]+)*)|(\".+\"))@(([^<>()[\]\.,;:\s@\"]+\.)+[^<>()[\]\.,;:\s@\"]{2,})$/i.test(e)},e.GetUrlParameter=function(e){var t=new RegExp("[?&]' + name + '=([^?&]+)").exec(window.location.search);return t&&t.length>1?t[1]:null},e.GetUrlParameterBoolean=function(e){var t=this.GetUrlParameter(e);return!!t&&"true"===decodeURIComponent(t).toLowerCase()},e.IsSameOriginal=function(t){var n=e.isLocalHost()?t.match(/http:\/\/([^\/]+)/):t.match(/https:\/\/([^\/]+)/);return n&&n.length>1&&n[1]===window.location.host},e.GetAllSubdomains=function(){var e=[],t=this.GetHostname().split("."),n=t.length;if(1===n)return t;for(var o=0;o<n-1;o++){var i=t.slice(o).join(".");e.push(i)}return e=e.reverse()},e.SetCookie=function(e,t,n,i){var a="";if(0!==n){var l=new Date;l.setTime(l.getTime()+24*n*60*60*1e3),a="; expires="+l.toUTCString()}var r="";i&&(r="; path="+i);for(var u=0,s=this.GetAllSubdomains();u<s.length;u++){var c=s[u],d="";"localhost"!==c&&(d="; domain=."+c);var p=e+"="+t+r+d+a;if(o.default.log("Setting cookie: "+p),document.cookie=p,n>=0&&this.GetCookie(e)===t){o.default.log("Cookie was successfully set.");break}}},e.GetCookie=function(e){if(e)for(var t=document.cookie,n=/([^=]*)=([^;]*);*/g,o=null;o=n.exec(t);)if(o&&3===o.length&&o[1].trim()===e)return o[2];return null},e.IsShellAppInstalledOnIE=function(){if(this.IsIE()){try{var t=new ActiveXObject(n.default.ShellAppActiveObject);if(t&&t.CheckExistence()){var i=t.GetVersion();return i&&(i=i.replace("@","."),e.SetCookie(n.default.LaunchFinishedCookieName,"yes",n.default.DefaultCookieExpireDays,"/"),e.SetCookie(n.default.ShellAppVersionCookieName,i,n.default.DefaultCookieExpireDays,"/")),o.default.log("IE: ShellApp version ${version} had been found"),!!i}}catch(e){}o.default.log("IE: No ShellApp had been found")}return!1},e._utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");for(var t="",n=0;n<e.length;n++){var o=e.charCodeAt(n);o<128?t+=String.fromCharCode(o):o>127&&o<2048?(t+=String.fromCharCode(o>>6|192),t+=String.fromCharCode(63&o|128)):(t+=String.fromCharCode(o>>12|224),t+=String.fromCharCode(o>>6&63|128),t+=String.fromCharCode(63&o|128))}return t},e.base64encode=function(e){var t,n,o,i,a,l,r,u="",s=0;for(e=this._utf8_encode(e);s<e.length;)t=e.charCodeAt(s++),n=e.charCodeAt(s++),o=e.charCodeAt(s++),i=t>>2,a=(3&t)<<4|n>>4,l=(15&n)<<2|o>>6,r=63&o,isNaN(n)?l=r=64:isNaN(o)&&(r=64),u=u+this._keyStr.charAt(i)+this._keyStr.charAt(a)+this._keyStr.charAt(l)+this._keyStr.charAt(r);return u},e.UrlEncodeBase64=function(e){var t=e.replace(/\//g,"_");return t=t.replace(/\+/g,"-"),t=t.replace(/=/g,"!")},e.AppendParameter=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return e+(e.indexOf("?")>0?"&":"?")+t.join("&")},e.TryAppendParameter=function(t,n){var i=t,a=e.GetUrlParameter(n);return i.indexOf(n+"=")>=0?o.default.log(" The given url contains the parameter you are trying to append. A possible issue here, and the appending operation aborted."):null!=a&&(i=e.AppendParameter(i,n+"="+a)),i},e.IsSupporttedBrowser=function(){return this.GetIsMobilePlatform()||this.IsIE()||this.IsSafari()||this.IsChrome()||this.IsEdge()||this.IsFireFox()||this.IsSfBShell()},e.InitAutoApplyString=function(e){for(var t in e){var o=t.match(/^aa_([^_]*)_(.*)/);if(o&&3===o.length)n.default.AutoApplyStrings[o[1]]=n.default.AutoApplyStrings[o[1]]||[],n.default.AutoApplyStrings[o[1]][o[2]]=e[t];else{var i=t.match(/^aaa_([^_]*)_(.*)/);i&&3===i.length&&(n.default.AutoApplyAriaStrings[i[1]]=n.default.AutoApplyAriaStrings[i[1]]||[],n.default.AutoApplyAriaStrings[i[1]][i[2]]=e[t])}}},e.RetryTask=function(t,n,o,i,a){return i=i||(new Date).getTime(),a=a||$.Deferred(),setTimeout(function(){o()?a.resolve():(new Date).getTime()-i<=n?e.RetryTask(t,n,o,i,a):a.reject()},t),a.promise()},e.localeString=null,e.isMobilePlatform=null,e.telemetryId=null,e._keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",e}();t.__esModule=!0,t.default=i}),define("utils/TelemetryEvent",["require","exports","utils/Constants"],function(e,t,n){"use strict";var o=function(){function e(){this.eventName="TelemetryEvent"}return e.prototype.getEventName=function(){return this.eventName},e}();t.TelemetryEvent=o;var i=function(e){function t(){e.apply(this,arguments),this.eventName="TelemetryInfoEvent"}return __extends(t,e),t.prototype.getTypeName=function(){return n.default.TelemetryInfoTypeName},t}(o);t.__esModule=!0,t.default=i;var a=(function(e){function t(){e.apply(this,arguments),this.eventName="TelemetryErrorEvent"}__extends(t,e),t.prototype.getTypeName=function(){return n.default.TelemetryErrorTypeName},t}(o),function(e){function t(t,n){e.call(this),this.eventName="ClientLaunchEvent",this.clientType=t,this.wasManual=n}return __extends(t,e),t}(i));t.ClientLaunchEvent=a;var l=function(e){function t(t){e.call(this),this.eventName="ClientLaunchStrategy",this.strategy=t}return __extends(t,e),t}(i);t.ClientLaunchStrategy=l;var r=function(e){function t(t){e.call(this),this.eventName="PageLoadEvent",this.pageName=t}return __extends(t,e),t}(i);t.PageLoadEvent=r;var u=function(e){function t(t){e.call(this),this.eventName="PluginClientDetection",this.detectedType=t}return __extends(t,e),t}(i);t.PluginClientDetection=u;var s=function(e){function t(t){e.call(this),this.eventName="ClientSelection",this.clientType=t}return __extends(t,e),t}(i);t.ClientSelection=s}),define("utils/Telemetry",["require","exports","utils/Constants","utils/Logger","utils/Helper","aria"],function(e,t,n,o,i){"use strict";var a=function(){function e(){}return e.checkStatusCallback=function(e,t,n,i){e===microsoft.applications.telemetry._sender.CallbackEventType.SEND_FAILED?o.default.error("Telemetry - Can't send out data - "+t):o.default.verbose("Telemetry - Sent.")},e.applyDefaultProperties=function(e){e.setProperty("telemetryId",i.default.GetTelemetryId()),e.setProperty("userAgent",i.default.GetUserAgent()),e.setProperty("locale",i.default.GetLocaleString()),e.setProperty("hostname",i.default.GetHostname()),e.setProperty("isOnPrem",i.default.GetIsOnPrem())},e.initilaize=function(){if(!e.telemetryInstance){o.default.verbose("Initializing Telemetry client.");var t=new microsoft.applications.telemetry.LogConfiguration;""===i.default.GetRedirectURL()&&(t.enableAutoUserSession=!0),microsoft.applications.telemetry.LogManager.initialize(n.default.AriaToken,t),microsoft.applications.telemetry.LogManager.addCallbackListener(e.checkStatusCallback),e.telemetryInstance=new microsoft.applications.telemetry.Logger}},e.logEvent=function(t){if(!i.default.GetIsOnPrem()||i.default.GetEnableTelemetry())if(e.initilaize(),o.default.verbose("Telemetry - Start: "+t.getEventName()),e.telemetryInstance){var n=new microsoft.applications.telemetry.EventProperties;n.name=t.getEventName(),n.eventType=t.getTypeName(),this.applyDefaultProperties(n);for(var a in t)t.hasOwnProperty(a)&&n.setProperty(a,t[a]);this.telemetryInstance.logEvent(n)}else o.default.error("Telemetry - Not initialized.")},e}();t.__esModule=!0,t.default=a}),define("viewloaders/ViewLoader",["require","exports","utils/Constants","utils/Helper","utils/Telemetry","utils/TelemetryEvent","jquery"],function(e,t,n,o,i,a){"use strict";!function(e){e[e.Redirect=0]="Redirect",e[e.ClientSelection=1]="ClientSelection",e[e.Launch=2]="Launch",e[e.Download=3]="Download",e[e.AllSet=4]="AllSet",e[e.Trouble=5]="Trouble",e[e.Error=6]="Error"}(t.PageTypes||(t.PageTypes={}));var l=t.PageTypes,r=function(){function e(){this.isCSSEnjected=!1}return e.prototype.LoadContent=function(e){var t=this;i.default.logEvent(new a.PageLoadEvent(l[e])),this.LoadCSS(),$.get(o.default.GetScriptRootPath()+"views/"+this.getPageFilename(e)+".html",function(n){$("body").html(n),t.InitTitlebar(),t.UpdateBackgroundImageCSS(),t.InitPageContent(e)})},e.prototype.getPageFilename=function(e){var t=!1;return o.default.GetIsMobilePlatform()&&(e!=l.Launch&&e!=l.AllSet||(t=!0)),(t?"m":"")+l[e]},e.prototype.InitTitlebar=function(){this.AutoApplyResourceString("common"),this.AutoApplyAriaResourceString("common")},e.prototype.InitPageContent=function(e){this.AutoApplyResourceString(this.getPageFilename(e)),this.AutoApplyAriaResourceString(this.getPageFilename(e)),this.InitPageDynamicContent(e)},e.prototype.LoadCSS=function(){var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href=o.default.GetScriptRootPath()+"css/app.css",document.head.appendChild(e)},e.prototype.UpdateBackgroundImageCSS=function(){if(!this.isCSSEnjected){var e=document.createElement("style");document.head.appendChild(e);e.sheet.insertRule(".main-background-bg { background-image: url("+o.default.GetScriptRootPath()+n.default.SkypeBGImagePath+"); }",0),this.isCSSEnjected=!0}},e.prototype.AutoApplyResourceString=function(e){var t=n.default.AutoApplyStrings[e.toLowerCase()];for(var o in t)$("#"+o).html(t[o])},e.prototype.AutoApplyAriaResourceString=function(e){var t=n.default.AutoApplyAriaStrings[e.toLowerCase()];for(var o in t)$("#"+o).attr("aria-label",t[o])},e}();t.__esModule=!0,t.default=r}),define("clientlaunchers/Helper/PluginLaunchHelper",["require","exports","utils/Logger","utils/Helper"],function(e,t,n,o){"use strict";!function(e){e[e.OC=0]="OC",e[e.Samara=1]="Samara",e[e.AOC=2]="AOC",e[e.LWA=3]="LWA"}(t.InstalledClient||(t.InstalledClient={}));var i=t.InstalledClient,a=function(){function e(){this._name=null,this._clsname=null,this._clsid=null,this._initProps=null,this.IdPrefix="_ucclient_plugin_",this.TagHtmlTemplateIE="<object classid='{0}' {1} ></object>",this.TagHtmlTemplateFF="<embed type='{0}' {1} ></embed>"}return e.GetConfigForClient=function(e,t){switch(e){case i.OC:return this.PluginConfigOC[t];case i.Samara:return this.PluginConfigSamara[t];case i.AOC:return this.PluginConfigAOC[t];case i.LWA:return this.PluginConfigLWA[t]}return null},e.prototype.Initialize=function(t,n,o,i){e._pluginInstance.object||(this._name=t,this._clsname=n,this._clsid=o,this._initProps=i)},e.prototype.LoadPlugin=function(){return e._pluginInstance.object?e._pluginInstance:(this.Create(),e._pluginInstance)},e.UnloadPlugin=function(){if(!e._pluginInstance.object)return void n.default.log("Already unloaded");if(this._pluginInstance.object instanceof Node){n.default.log("Unload by removing node");try{var t=this._pluginInstance.object.parentNode;document.body.removeChild(t)}catch(e){n.default.error("Can't remove node")}}this._pluginInstance.object=null,n.default.log("Unloaded done")},e.GetBrowserTag=function(){return o.default.IsIE()?"IE":"FF"},e.DetectPlugin=function(t,a){var l=!1;if(!o.default.IsIE()&&!o.default.IsSafari())return!1;try{var r=this.GetBrowserTag(),u=this.GetConfigForClient(t,r);if(!u)return!1;var s=new e;s.Initialize(i[t],u.Version_Name,u.Version_CLSID,null);var c=s.LoadPlugin();if(!c.object)return n.default.log("Plugin is not installed."),!1;a&&(n.default.log("Invoke callback"),a(c.object)),l=!0,null!=s&&this.UnloadPlugin(),n.default.log("plugin detected!")}catch(e){n.default.error("DetectPlugin Exception: "+e),l=!1}return l},e.prototype.Create=function(){if(this._clsname)try{o.default.IsIE()?e._pluginInstance.object=new ActiveXObject(this._clsname):(n.default.error("Only IE support this"),e._pluginInstance.object=null)}catch(e){n.default.error("Can't create ActiveXObject")}else if(this._clsid){if(!this.IsPluginAvailable())return void n.default.error("Plugin is not available");var t="";if(this._initProps)for(var i in this._initProps)t+=" "+i+"='"+this._initProps[i]+"'";var a=o.default.getFormatedString(o.default.IsIE()?this.TagHtmlTemplateIE:this.TagHtmlTemplateFF,this._clsid,t);try{var l=this.CreateNodeOutside("DIV");l.innerHTML=a;var r=l.firstChild;r.id=this.IdPrefix+this._name,e._pluginInstance.object=r}catch(e){n.default.error("can't create node for object")}}},e.prototype.CreateNodeOutside=function(e){var t=document.createElement(e||"DIV");return document.body.appendChild(t),t.style.position="absolute",t.style.width="1px",t.style.height="1px",t.style.left="-100px",t.style.top="0px",t.style.overflow="hidden",t.style.visibility="hidden",t},e.prototype.IsPluginAvailable=function(){var e=!1;if(!o.default.IsIE()){navigator.plugins.refresh();var t=navigator.mimeTypes[this._clsid];if(t){null!=t.enabledPlugin&&(e=!0)}}return e},e._pluginInstance={},e.PluginConfigLWA={IE:{Version_Name:"Microsoft.SkypeForBusinessPlugin16.2.VersionQuery"},FF:{Version_CLSID:"application/x-skypeforbusiness-plugin-16.2"}},e.PluginConfigOC={IE:{Version_Name:"CommunicatorMeetingJoinAx.JoinManager"},FF:{Version_CLSID:"application/vnd.microsoft.communicator.ocsmeeting"}},e.PluginConfigSamara={IE:{Version_Name:"AttendantConsoleMeetingJoinAx.JoinManager"},FF:{Version_CLSID:"application/vnd.microsoft.attendantconsole.ocsmeeting"}},e.PluginConfigAOC={IE:{Version_Name:"CommunicatorAttendeeMeetingJoinAx.JoinManager"},FF:{Version_CLSID:"application/vnd.microsoft.communicatorattendee.ocsmeeting"}},e}();t.__esModule=!0,t.default=a}),define("clientlaunchers/DesktopClientLaunchers/LwaClientLauncher",["require","exports","utils/Constants","utils/Logger","clientlaunchers/Helper/PluginLaunchHelper","utils/Helper","utils/Telemetry","utils/TelemetryEvent"],function(e,t,n,o,i,a,l,r){"use strict";var u=function(){function e(e){this.lwaWebPoolUrl=e}return e.CanDetectClient=function(){return o.default.log("Check LWA app installed state"),i.default.DetectPlugin(i.InstalledClient.LWA)},e.prototype.Execute=function(e){o.default.log("Going to launch LWA "),l.default.logEvent(new r.ClientLaunchEvent("LwaClient",e));var t=a.default.UrlEncodeBase64(a.default.base64encode(a.default.GetCurrentUrl())),i=a.default.AppendParameter(this.lwaWebPoolUrl,"meeturl="+t),u=a.default.AppendParameter(i,"wk=2"),s=n.default.ShellAppLaunchProtocol+u;o.default.log("Launching LWA with url: "+s),l.default.logEvent(new r.ClientLaunchStrategy("LwaProtocolHandler")),window.location.href=s},e}();t.__esModule=!0,t.default=u}),define("clientlaunchers/DesktopClientLaunchers/MacClientLauncher",["require","exports","utils/Logger","clientlaunchers/Helper/PluginLaunchHelper","utils/Telemetry","utils/TelemetryEvent"],function(e,t,n,o,i,a){"use strict";var l=function(){function e(e,t){this.conferenceUri=e,this.unescapedLaunchInfoXml=t}return e.prototype.LaunchByChromeSkypeProtocolHandler=function(){i.default.logEvent(new a.ClientLaunchStrategy("ProtocolHandler")),window.location.href=this.conferenceUri},e.CanDetectClient=function(){return n.default.log("Check Mac client installed state"),o.default.DetectPlugin(o.InstalledClient.OC)},e.prototype.Execute=function(e){n.default.log("Going to launch Mac client using protocol handler"),i.default.logEvent(new a.ClientLaunchEvent("MacClient",e)),this.LaunchByChromeSkypeProtocolHandler()},e}();t.__esModule=!0,t.default=l}),define("clientlaunchers/DesktopClientLaunchers/WindowsDesktopClientLauncher",["require","exports","utils/Helper","utils/Logger","clientlaunchers/Helper/PluginLaunchHelper","utils/Telemetry","utils/TelemetryEvent"],function(e,t,n,o,i,a,l){"use strict";var r=function(){function e(e,t){this.lyncJoinConferenceUrl="lync://",this.lync15JoinConferenceUrl="lync15:",this.lync15DesktopJoinConfUrl="lync15classic:",this.lync15MobileJoinConfUrl="lync15://",this.mlxJoinConfUrl="lync15mlx:",this.confJoinParams="confjoin?url=","#"===e.slice(-1)&&(e=e.substring(0,e.length-1)),this.launchInfoUrl=e,this.unescapedLaunchInfoXml=t}return e.prototype.LaunchByPlugin=function(){var e=this;return i.default.DetectPlugin(i.InstalledClient.OC,function(t){o.default.log("Unescaped xml: "+e.unescapedLaunchInfoXml),a.default.logEvent(new l.ClientLaunchStrategy("Plugin")),t.LaunchUCClient(e.unescapedLaunchInfoXml)})},e.CanDetectClient=function(){return o.default.log("Check Windows client installed state"),i.default.DetectPlugin(i.InstalledClient.OC)},e.prototype.LaunchByProtocolHandler=function(){var e=this.lync15JoinConferenceUrl+this.confJoinParams+encodeURIComponent(this.launchInfoUrl);o.default.log("LaunchURL: "+e),a.default.logEvent(new l.ClientLaunchStrategy("ProtocolHandler")),window.location.href=e},e.prototype.LaunchByMsLaunchUri=function(){a.default.logEvent(new l.ClientLaunchStrategy("msLaunchUri"));var e=this.lync15JoinConferenceUrl+this.confJoinParams+document.URL;o.default.log("Launching with msLaunchUri: "+e),navigator.msLaunchUri(e,null,this.LaunchByPlugin)},e.prototype.LaunchFirefox=function(){$("#shellapp_iframe").attr("src",this.lync15JoinConferenceUrl+this.confJoinParams+encodeURIComponent(this.launchInfoUrl))},e.prototype.IsIeBrowserProtocolHandlerSupported=function(){return!!navigator.msLaunchUri},e.prototype.IsChromeBrowserNpapiDeprecated=function(){var e=/Chrome\/([0-9]+)/,t=e.exec(n.default.GetUserAgent());return null!==t&&parseInt(t[1],10)>=42},e.prototype.IsSupportedBrowser=function(){return n.default.IsChrome()||n.default.IsEdge()||n.default.IsIE()||n.default.IsFireFox()},e.prototype.Execute=function(e){o.default.log("Going to launch Windows client "),a.default.logEvent(new l.ClientLaunchEvent("WindowsDesktopClient",e)),this.IsSupportedBrowser()&&(n.default.IsFireFox()?(o.default.log("Launching from Firefox."),this.LaunchFirefox()):n.default.IsChrome()&&this.IsChromeBrowserNpapiDeprecated()?(o.default.log("Launching with protocol handler."),this.LaunchByProtocolHandler()):this.IsIeBrowserProtocolHandlerSupported()?(o.default.log("Launching with msLaunchUri"),this.LaunchByMsLaunchUri()):(o.default.log("Launching with NPAPI plugin."),this.LaunchByPlugin()))},e}();t.__esModule=!0,t.default=r}),define("clientlaunchers/DesktopClientLauncher",["require","exports","utils/Helper","clientlaunchers/DesktopClientLaunchers/LwaClientLauncher","clientlaunchers/DesktopClientLaunchers/MacClientLauncher","clientlaunchers/DesktopClientLaunchers/WindowsDesktopClientLauncher"],function(e,t,n,o,i,a){"use strict";!function(e){e[e.NotSupportted=0]="NotSupportted",e[e.NotInstalled=1]="NotInstalled",e[e.Installed=2]="Installed",e[e.InstallFailed=3]="InstallFailed"}(t.ClientInstallState||(t.ClientInstallState={}));var l=(t.ClientInstallState,function(){function e(e,t,n){this.launchInfoUrl=e,this.unescapedLaunchInfoXml=t,this.confUri=n,this.clientLauncher=this.GetDesktopClientLauncher()}return e.prototype.GetDesktopClientLauncher=function(){return n.default.IsWindows()?new a.default(this.launchInfoUrl,this.unescapedLaunchInfoXml):n.default.IsMac()?new i.default(this.confUri,this.unescapedLaunchInfoXml):void 0},e.prototype.IsSupportedPlatform=function(){return n.default.IsWindows()||n.default.IsMac()},e.CanDetectNativeClient=function(){if(n.default.IsWindows()){if(a.default.CanDetectClient())return!0}else if(n.default.IsMac()&&i.default.CanDetectClient())return!0;return!1},e.CanDetectWebClient=function(){return o.default.CanDetectClient()},e.prototype.Execute=function(e){this.IsSupportedPlatform()&&this.clientLauncher.Execute(e)},e}());t.__esModule=!0,t.default=l}),define("clientlaunchers/MobileClientLaunchers/AndroidMobileClientAppLauncher",["require","exports","utils/Helper","utils/Logger"],function(e,t,n,o){"use strict";var i=function(){function e(){var e=this;this.GetAppDownloadFwdLink=function(){return e.appDownloadFwdLink},this.GetNoAppTimeout=function(){return e.noAppTimeout},this.GetBrowserBackupRedirectLink=function(){return""},this.IsIntentBasedChromeBrowser=function(){var e=/Chrome\/([0-9]+)/,t=e.exec(n.default.GetUserAgent());return null!==t&&parseInt(t[1],10)>=25},this.LaunchMobileApp=function(t){var n="";n=e.IsIntentBasedChromeBrowser()?""===t?"intent://"+e.launchParams+"#Intent;scheme=lync;package=com.microsoft.office.lync15;end":"intent://"+e.launchParams+"="+t+"#Intent;scheme=lync;package=com.microsoft.office.lync15;end":e.protocolHandlerPrefix+e.launchParams+"="+t,o.default.log("Trying to launch Android app with URL: "+n),window.top.location=n},this.protocolHandlerPrefix="lync://",this.launchParams="confjoin?url",this.noAppTimeout=1500,this.appDownloadFwdLink="http://go.microsoft.com/fwlink/?LinkId=217189"}return e}();t.__esModule=!0,t.default=i}),define("clientlaunchers/MobileClientLaunchers/IPhoneMobileClientAppLauncher",["require","exports","utils/Logger"],function(e,t,n){"use strict";var o=function(){function e(){var e=this;this.GetAppDownloadFwdLink=function(){return e.appDownloadFwdLink},this.GetNoAppTimeout=function(){return e.noAppTimeout},this.GetBrowserBackupRedirectLink=function(){return e.appDownloadFwdLink},this.LaunchMobileApp=function(t){var o=e.protocolHandler+t;n.default.log("Trying to launch iOS app with URL: "+o),window.top.location=o},this.protocolHandler="lync://confjoin?url=",this.noAppTimeout=1e4,this.appDownloadFwdLink="http://go.microsoft.com/fwlink/?LinkId=217185"}return e}();t.__esModule=!0,t.default=o}),define("clientlaunchers/MobileClientLaunchers/WindowsPhoneClientAppLauncher",["require","exports","utils/Logger"],function(e,t,n){"use strict";var o=function(){function e(){var e=this;this.GetAppDownloadFwdLink=function(){return e.appDownloadFwdLink},this.GetNoAppTimeout=function(){return e.noAppTimeout},this.GetBrowserBackupRedirectLink=function(){return""},this.LaunchMobileApp=function(t){var o=e.protocolHandler+t;n.default.log("Trying to launch Windows Phone app with URL: "+o),window.top.location=o},this.protocolHandler="lync://confjoin?url=",this.noAppTimeout=1500,this.appDownloadFwdLink="https://go.microsoft.com/fwlink/?linkid=386403"}return e}();t.__esModule=!0,t.default=o}),define("clientlaunchers/MobileClientLauncher",["require","exports","utils/Helper","utils/Logger","clientlaunchers/MobileClientLaunchers/AndroidMobileClientAppLauncher","clientlaunchers/MobileClientLaunchers/IPhoneMobileClientAppLauncher","clientlaunchers/MobileClientLaunchers/WindowsPhoneClientAppLauncher"],function(e,t,n,o,i,a,l){"use strict";var r=function(){function e(e){this.meetingLaunchInfoUrl=e,this.InitializeMobileClientAppLauncher(),null!=this.mobileclientAppLauncher&&(this.browserBackupLink=this.mobileclientAppLauncher.GetBrowserBackupRedirectLink())}return e.prototype.InitializeMobileClientAppLauncher=function(){n.default.IsWinPhone()?(o.default.log("Creating Windows Phone launcher."),this.mobileclientAppLauncher=new l.default):n.default.IsIOS()?(o.default.log("Creating iOS launcher."),this.mobileclientAppLauncher=new a.default):n.default.IsAndroid()?(o.default.log("Creating Android launcher."),this.mobileclientAppLauncher=new i.default):(o.default.log("Could not find a matching mobile device launcher."),this.mobileclientAppLauncher=null)},e.prototype.LaunchAppStore=function(){var e=this.mobileclientAppLauncher.GetAppDownloadFwdLink();o.default.log("Redirecting to App Store URL: "+e),window.open(e,"_blank")},e.prototype.UpdateUxForUnSupportedPlatform=function(){},e.prototype.UpdateAppFwdLinkInUx=function(){},e.prototype.CanLaunchApp=function(){return n.default.IsAndroid()||n.default.IsIOS()||n.default.IsWinPhone()},e.onNoAppTimeOut=function(e){},e.prototype.LaunchAppThroughProtocolHandler=function(){this.mobileclientAppLauncher.LaunchMobileApp(this.meetingLaunchInfoUrl);var t=this.mobileclientAppLauncher.GetBrowserBackupRedirectLink();setTimeout(function(){e.onNoAppTimeOut(t)},this.mobileclientAppLauncher.GetNoAppTimeout())},e.prototype.Execute=function(){this.CanLaunchApp()?this.LaunchAppThroughProtocolHandler():this.UpdateUxForUnSupportedPlatform()},e}();t.__esModule=!0,t.default=r}),define("viewloaders/HttpsViewLoader",["require","exports","clientlaunchers/DesktopClientLauncher","clientlaunchers/DesktopClientLaunchers/LwaClientLauncher","clientlaunchers/MobileClientLauncher","viewloaders/ViewLoader","utils/Constants","utils/Helper","utils/Logger","utils/Telemetry","utils/TelemetryEvent","jquery"],function(e,t,n,o,i,a,l,r,u,s,c){"use strict";var d;!function(e){e[e.None=0]="None",
e[e.Native=1]="Native",e[e.Web=2]="Web"}(d||(d={}));var p=function(e){function t(){e.apply(this,arguments),this.bubbleTimerId=0,this.launchType=d.None,this.hasNativeClient=!1,this.hasWebClient=!1}return __extends(t,e),t.prototype.LoadViews=function(){this.LoadContent(this.getPageType())},t.prototype.getPageType=function(){if(r.default.GetIsMobilePlatform())return u.default.log("Try to launch mobile browser."),a.PageTypes.Launch;if(!r.default.IsValidMeeting()||r.default.GetErrorType()!==l.ErrorType.None)return a.PageTypes.Error;if(""!==r.default.GetRedirectURL())return u.default.log("Redirecting to "+r.default.GetRedirectURL()),a.PageTypes.Redirect;if(r.default.IsIE()||l.default.IsSafariPluginDetectionEnabled&&r.default.IsSafari())u.default.log("We can detect the client."),this.hasNativeClient=n.default.CanDetectNativeClient(),this.hasWebClient=n.default.CanDetectWebClient(),this.hasNativeClient?(u.default.log("Native client installed"),s.default.logEvent(new c.PluginClientDetection("Native")),this.launchType=d.Native):this.hasWebClient?(u.default.log("LWA app installed"),s.default.logEvent(new c.PluginClientDetection("LWA")),this.launchType=d.Web):(u.default.log("Neither native client nor LWA was found installed"),s.default.logEvent(new c.PluginClientDetection("None")),this.launchType=d.None);else{u.default.log("Cannot detect client, check if cookie has been set."),this.hasNativeClient=!0,this.hasWebClient=!0;var e=r.default.GetCookie(l.default.ClientSelectionCookieName);if(null==e)return u.default.log("ClientSelectionCookie is null, show selection page"),a.PageTypes.ClientSelection;u.default.log("ClientSelectionCookie is set to "+e),this.launchType=e===l.default.LwaClient?d.Web:d.Native}return this.launchType===d.None?(u.default.log("Try to download web client"),a.PageTypes.Download):(u.default.log("Try to launch client"),a.PageTypes.AllSet)},t.prototype.InitPageDynamicContent=function(e){switch(e){case a.PageTypes.Redirect:this.onRedirectPage();break;case a.PageTypes.ClientSelection:this.onClientSelectionPage();break;case a.PageTypes.Launch:this.onLaunchPage();break;case a.PageTypes.Download:this.onDownloadPage();break;case a.PageTypes.AllSet:this.onAllSetPage();break;case a.PageTypes.Trouble:this.onTroublePage();break;default:this.onErrorPage()}},t.prototype.onRedirectPage=function(){u.default.log("Redirect page"),$("#redirectIFrame").attr("src",r.default.GetRedirectURL())},t.prototype.onClientSelectionPage=function(){var e=this;u.default.log("ClientSelect page"),$("#skype_logo").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),$("#dialog_desktopclient").click(function(){u.default.log("Selected to launch Desktop Client"),s.default.logEvent(new c.ClientSelection("Native")),r.default.SetCookie(l.default.ClientSelectionCookieName,l.default.DesktopClient,l.default.DefaultCookieExpireDays),e.launchType=d.Native,e.LoadContent(a.PageTypes.AllSet)}),$("#dialog_lwaclient").click(function(){u.default.log("Selected to launch LWA client"),s.default.logEvent(new c.ClientSelection("LWA")),r.default.SetCookie(l.default.ClientSelectionCookieName,l.default.LwaClient,l.default.DefaultCookieExpireDays),e.launchType=d.Web,e.LoadContent(a.PageTypes.Download)}),$("#dialog_here").attr("href",l.default.HelpUrl)},t.prototype.onLaunchPage=function(){if(u.default.log("Launch page"),$("#skype_logo").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),r.default.GetIsMobilePlatform()){var e=new i.default(r.default.GetMeetUrl());e.Execute(),$("#skype_logo1").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),r.default.IsAndroid()?($("#skype_logo2").attr("src",r.default.GetScriptRootPath()+l.default.SkypeAppLogoImagePathAndroid),$("#dialog_here").attr("href",l.default.HelpUrlAndroid),$("#dialog_reminder").hide()):($("#skype_logo2").attr("src",r.default.GetScriptRootPath()+l.default.SkypeAppLogoImagePathiOS),$("#dialog_here").attr("href",l.default.HelpUrliOS),$("#dialog_reminder").show()),$("#dialog_download").click(function(){e.LaunchAppStore()}),$("#dialog_submit").click(function(){e.Execute()})}else $("#dialog_submit").click(function(){new o.default(r.default.GetLwaURL()).Execute(!0)}),$("#dialog_here").attr("href",l.default.HelpUrl)},t.prototype.onDownloadPage=function(){var e=this;u.default.log("Download page"),$("#skype_logo").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),$("#skype_spin").attr("src",r.default.GetScriptRootPath()+l.default.SkypeJoinSpinImagePath),$("#dialog_download").attr("href",r.default.GetSkypeMeetingAppOrPlugInUrl()),$("#downloadapp_iframe").attr("src",r.default.GetSkypeMeetingAppOrPlugInUrl()),$("#dialog_here").attr("href",l.default.HelpUrl),this.TriggerDownloadBubble(!0),r.default.IsIE()||l.default.IsSafariPluginDetectionEnabled&&r.default.IsSafari()?(u.default.log("Try to detect download progress"),r.default.RetryTask(l.default.TimeoutForCheckDownload,l.default.TimeoutForCancelDownload,function(){return o.default.CanDetectClient()}).done(function(){u.default.log("Download finished"),e.launchType=d.Web,e.LoadContent(a.PageTypes.AllSet)}).fail(function(){u.default.log("Download fail, show the troubleshooting page."),e.LoadContent(a.PageTypes.Trouble)})):setTimeout(function(){e.LoadContent(a.PageTypes.Launch)},l.default.TimeoutForDownload)},t.prototype.onAllSetPage=function(){var e=this;u.default.log("AllSet page"),this.launchType===d.Web?($("#dialog_desktop").show(),this.hasNativeClient?$("#dialog_desktop_exist").show():$("#dialog_desktop_exist").hide(),$("#dialog_lwa").hide(),new o.default(r.default.GetLwaURL()).Execute(!1)):($("#dialog_lwa").show(),$("#dialog_desktop").hide(),new n.default(document.URL,r.default.GetEscapedXml(),r.default.GetLyncLaunchLink()).Execute(!1)),$("#skype_logo").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),$("#dialog_desktop_help").click(function(){e.LoadContent(a.PageTypes.Trouble)}),$("#dialog_desktop_link").click(function(){u.default.log("Manually launch native client"),e.launchType=d.Native,e.LoadContent(a.PageTypes.AllSet),r.default.SetCookie(l.default.ClientSelectionCookieName,l.default.DesktopClient,l.default.DefaultCookieExpireDays)}),$("#dialog_lwa_link").click(function(){u.default.log("Manually launch web app"),e.launchType=d.Web,e.LoadContent(a.PageTypes.AllSet),r.default.SetCookie(l.default.ClientSelectionCookieName,l.default.LwaClient,l.default.DefaultCookieExpireDays)}),r.default.GetIsMobilePlatform&&$("#dialog_install").attr("href",r.default.GetSkypeMeetingAppOrPlugInUrl()),$("#dialog_here").attr("href",l.default.HelpUrl)},t.prototype.onTroublePage=function(){u.default.log("Trouble page"),$("#skype_logo").attr("src",r.default.GetScriptRootPath()+l.default.SkypeTitleLogoImagePath),$("#dialog_install").attr("href",r.default.GetSkypeMeetingAppOrPlugInUrl()),$("#dialog_submit").click(function(){u.default.log("Manually launch web app in step 3"),new o.default(r.default.GetLwaURL()).Execute(!0)}),$("#dialog_here").attr("href",l.default.HelpUrl)},t.prototype.onErrorPage=function(){var e=r.default.GetErrorType();switch(u.default.log("Error page, error type: "+l.ErrorType[e]),e===l.ErrorType.ServerBusy?$("#dialog_titleserverbusy").show():$("#dialog_titletrouble").show(),e){case l.ErrorType.ServerBusy:$("#dialog_descriptionserverbusy").show();break;case l.ErrorType.FailedOver:$("#dialog_descriptionfailover").show();break;case l.ErrorType.InvalidConference:$("#dialog_descriptionexpiredinvalid").show();break;default:$("#dialog_descriptionother").show()}$("#dialog_shareerror").click(function(){u.default.log("Showing the diag info."),$("#dialog_diaginfo").text(r.default.GetDiagInfo()),$("#dialog_diaginfo").show()})},t.prototype.TriggerDownloadBubble=function(e){if(r.default.IsChrome())$("#dialog_bubble").addClass("download-bubble-chrome");else if(r.default.IsIE()||r.default.IsEdge())$("#dialog_bubble").addClass("download-bubble-ie");else if(r.default.IsSafari())$("#dialog_bubble").addClass("top download-bubble-safari"),$("#dialog_bubble").html(r.default.getFormatedString(l.default.LocalizedStrings.download_dialog_bubble,r.default.GetScriptRootPath()+l.default.SkypeSafariImagePath));else{if(!r.default.IsFireFox())return;$("#dialog_bubble").addClass("top download-bubble-safari"),$("#dialog_bubble").html(r.default.getFormatedString(l.default.LocalizedStrings.download_dialog_bubble,r.default.GetScriptRootPath()+l.default.SkypeFirefoxImagePath))}0!==this.bubbleTimerId&&(clearTimeout(this.bubbleTimerId),this.bubbleTimerId=0),e?(u.default.log("Show download bubble"),$("#dialog_bubble").show(),this.bubbleTimerId=setTimeout(function(){u.default.log("Hide download bubble after timeout"),$("#dialog_bubble").hide()},l.default.TimeoutForDownloadBubble)):(u.default.log("Hide download bubble manually"),$("#dialog_bubble").hide())},t}(a.default);t.__esModule=!0,t.default=p}),define("app",["require","exports","viewloaders/HttpsViewLoader","utils/Helper","utils/Logger","utils/Constants"],function(e,t,n,o,i,a){"use strict";$(function(){var t=o.default.GetLocaleString();i.default.log("Loading strings from: nls/"+t+"/strings"),e(["i18n!nls/"+t+"/strings"],function(e){a.default.LocalizedStrings=e,o.default.InitAutoApplyString(e),(new n.default).LoadViews()})})}),define("tests/TestUtilities",["require","exports","utils/Helper"],function(e,t,n){"use strict";var o=function(){function e(){}return e.SetMockUserAgent=function(e){sinon.stub(n.default,"GetUserAgent",function(){return e})},e.ResetMockUserAgent=function(){sinon.restore(n.default.GetUserAgent)},e.SetMockPlatform=function(e){sinon.stub(n.default,"GetPlatform",function(){return e})},e.ResetMockPlatform=function(){sinon.restore(n.default.GetPlatform)},e}();t.__esModule=!0,t.default=o}),define("tests/clientlaunchers/windowsdesktopclientlauncher.test",["require","exports","utils/Helper","utils/Constants","tests/TestUtilities","clientlaunchers/DesktopClientLaunchers/WindowsDesktopClientLauncher","clientlaunchers/DesktopClientLaunchers/MacClientLauncher","clientlaunchers/DesktopClientLaunchers/LwaClientLauncher","clientlaunchers/DesktopClientLauncher"],function(e,t,n,o,i,a,l,r,u){"use strict";QUnit.test("Test Chrome NPAPI deprecation",function(e){var t=new a.default("","");i.default.SetMockUserAgent("Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/40.0.2840.99 Safari/537.36"),e.notOk(t.IsChromeBrowserNpapiDeprecated(),"Expect Npapi to not be deprecated on old version."),i.default.ResetMockUserAgent();i.default.SetMockUserAgent("Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.99 Safari/537.36"),e.ok(t.IsChromeBrowserNpapiDeprecated(),"Expect Npapi to be deprecated on new version."),i.default.ResetMockUserAgent()}),QUnit.test("Test client preference",function(e){n.default.SetCookie(o.default.ClientSelectionCookieName,"",-1),i.default.SetMockPlatform("Win32");var t=new u.default("","","");e.ok(t.GetDesktopClientLauncher()instanceof a.default,"Expect WindowsDesktopClientLauncher to be returned."),i.default.ResetMockPlatform(),i.default.SetMockPlatform("Mac");var t=new u.default("","","");e.ok(t.GetDesktopClientLauncher()instanceof l.default,"Expect MacClientLauncher to be returned."),i.default.ResetMockPlatform()}),QUnit.test("Test LWA client cookie set",function(e){n.default.SetCookie(o.default.ClientSelectionCookieName,o.default.LwaClient,1),i.default.SetMockPlatform("Win32");var t=new u.default("","","");e.ok(t.GetDesktopClientLauncher()instanceof r.default,"Expect LwaClientLauncher to be returned."),i.default.ResetMockPlatform(),i.default.SetMockPlatform("Mac");var t=new u.default("","","");e.ok(t.GetDesktopClientLauncher()instanceof r.default,"Expect LwaClientLauncher to be returned."),i.default.ResetMockPlatform()})});